{% doc %}
  Renders a single product card — High-End Editorial dark theme.
  Must be rendered inside .coll-grid for CSS scoping.

  @param {product} product  - The product object
  @param {boolean} [offset] - Adds vertical stagger margin on even cards (desktop)
  @param {boolean} [eager]  - Load primary image eagerly (pass true for first 4 cards)

  @example
  {% render 'product-card', product: product, eager: true %}
  {% render 'product-card', product: product, offset: true %}
{% enddoc %}

{%- assign img_loading = 'lazy' -%}
{%- if eager -%}{%- assign img_loading = 'eager' -%}{%- endif -%}

<article class="pc{% if offset %} pc--offset{% endif %}">
  <a class="pc__link" href="{{ product.url }}" aria-label="{{ product.title | escape }}">

    <div class="pc__media">

      {% if product.featured_image %}
        {{ product.featured_image
          | image_url: width: 1200, height: 1600, crop: 'center'
          | image_tag:
            class: 'pc__img pc__img--primary',
            loading: img_loading,
            widths: '480, 720, 960, 1200',
            sizes: '(max-width: 640px) 100vw, (max-width: 1100px) 50vw, 33vw'
        }}
      {% else %}
        <div class="pc__img-placeholder"></div>
      {% endif %}

      {% if product.images[1] %}
        {{ product.images[1]
          | image_url: width: 1200, height: 1600, crop: 'center'
          | image_tag:
            class: 'pc__img pc__img--alt',
            loading: 'lazy',
            widths: '480, 720, 960, 1200',
            sizes: '(max-width: 640px) 100vw, (max-width: 1100px) 50vw, 33vw',
            aria_hidden: 'true'
        }}
      {% endif %}

      {% if product.compare_at_price_max > product.price %}
        <span class="pc__badge">{{ 'collections.sale_badge' | t }}</span>
      {% endif %}

    </div>

    <div class="pc__info">
      <h2 class="pc__name">{{ product.title | upcase | escape }}</h2>
      <p class="pc__price">
        {% if product.compare_at_price_max > product.price %}
          <s class="pc__price-was">{{ product.compare_at_price_max | money }}</s>
        {% endif %}
        {{ product.price | money }}
      </p>
    </div>

  </a>
</article>

{% stylesheet %}
  /* ─── TOKENS ──────────────────────────────────────────────── */
  .pc {
    --cream:  #f0ede5;
    --muted:  rgba(240, 237, 229, 0.45);
    --dark:   #0a0a09;
    --dim:    #141412;
    --serif:  var(--font-heading--family, "Playfair Display", Georgia, serif);
    --sans:   var(--font-body--family,    "Work Sans", system-ui, sans-serif);
  }

  /* ─── CARD — kill all base-theme overrides ────────────────── */
  .coll-grid .pc {
    display:          block !important;
    background:       #0a0a09 !important;
    background-color: #0a0a09 !important;
    border:           none !important;
    border-radius:    0 !important;
    box-shadow:       none !important;
    outline:          none !important;
    padding:          0 !important;
    margin:           0 !important;
  }

  .coll-grid .pc--offset {
    margin-top: var(--offset, 3rem) !important;
  }

  /* ─── LINK ───────────────────────────────────────────────── */
  .coll-grid .pc__link {
    display:          block !important;
    text-decoration:  none !important;
    color:            #f0ede5 !important;
    background:       #0a0a09 !important;
    background-color: #0a0a09 !important;
    border:           none !important;
    border-radius:    0 !important;
    box-shadow:       none !important;
    outline-offset:   4px;
  }

  /* ─── PHOTO CONTAINER ────────────────────────────────────── */
  .coll-grid .pc__media {
    position:      relative !important;
    overflow:      hidden !important;
    aspect-ratio:  3 / 4 !important;
    /* slightly lighter bg so card is visible even before image loads */
    background:    #1c1b19 !important;
    border-radius: 0 !important;
    border:        none !important;
    box-shadow:    none !important;
    display:       block !important;
  }

  /* ─── IMAGES ─────────────────────────────────────────────── */
  .coll-grid .pc__img {
    position:      absolute !important;
    inset:         0 !important;
    width:         100% !important;
    height:        100% !important;
    object-fit:    cover !important;
    border-radius: 0 !important;
    border:        none !important;
    margin:        0 !important;
    padding:       0 !important;
    transition:
      opacity   500ms ease,
      transform 650ms cubic-bezier(0.22, 1, 0.36, 1);
  }

  .coll-grid .pc__img--primary { opacity: 1; transform: scale(1); }
  .coll-grid .pc__img--alt     { opacity: 0; transform: scale(1.04); }

  .coll-grid .pc__link:hover .pc__img--primary,
  .coll-grid .pc__link:focus-visible .pc__img--primary {
    opacity: 0; transform: scale(1.04);
  }
  .coll-grid .pc__link:hover .pc__img--alt,
  .coll-grid .pc__link:focus-visible .pc__img--alt {
    opacity: 1; transform: scale(1);
  }
  .coll-grid .pc__link:hover .pc__img--primary:only-child {
    opacity: 1; transform: scale(1.04);
  }

  .coll-grid .pc__img-placeholder {
    position:   absolute;
    inset:      0;
    background: #1c1b19;
  }

  /* ─── SALE BADGE ─────────────────────────────────────────── */
  .coll-grid .pc__badge {
    position:        absolute !important;
    top:             1rem !important;
    left:            0 !important;
    z-index:         2 !important;
    background:      transparent !important;
    background-color: transparent !important;
    color:           #f0ede5 !important;
    font-family:     var(--sans) !important;
    font-size:       0.52rem !important;
    letter-spacing:  0.26em !important;
    text-transform:  uppercase !important;
    padding:         0.2rem 0.5rem !important;
    border-radius:   0 !important;
    border:          1px solid rgba(240, 237, 229, 0.5) !important;
    box-shadow:      none !important;
    line-height:     1.4 !important;
  }

  /* ─── INFO — breathing room below photo ─────────────────── */
  .coll-grid .pc__info {
    padding:          0 !important;
    margin-top:       1.2rem !important;
    margin-right:     0 !important;
    margin-bottom:    0 !important;
    margin-left:      0 !important;
    background:       #0a0a09 !important;
    background-color: #0a0a09 !important;
    border:           none !important;
    box-shadow:       none !important;
    border-radius:    0 !important;
    display:          flex !important;
    flex-direction:   column !important;
    gap:              0 !important;
  }

  /* ─── TITLE — uppercase sans-serif ──────────────────────── */
  .coll-grid .pc__name {
    font-family:    var(--sans) !important;
    font-size:      0.85rem !important;
    font-weight:    400 !important;
    letter-spacing: 0.12em !important;
    text-transform: uppercase !important;
    color:          #e6e1d6 !important;
    line-height:    1.45 !important;
    margin:         0 !important;
    padding:        0 !important;
    background:     transparent !important;
    border:         none !important;
    white-space:    nowrap;
    overflow:       hidden;
    text-overflow:  ellipsis;
  }

  /* ─── PRICE — serif italic, separated from title ────────── */
  .coll-grid .pc__price {
    font-family:  var(--serif) !important;
    font-style:   italic !important;
    font-size:    1rem !important;
    font-weight:  400 !important;
    color:        rgba(230, 225, 214, 0.7) !important;
    display:      flex !important;
    align-items:  baseline !important;
    gap:          0.4rem !important;
    margin-top:   0.5rem !important;
    margin-right: 0 !important;
    margin-bottom: 0 !important;
    margin-left:  0 !important;
    padding:      0 !important;
    background:   transparent !important;
    border:       none !important;
  }

  .coll-grid .pc__price-was {
    font-style:      normal !important;
    font-size:       0.75rem !important;
    color:           rgba(240, 237, 229, 0.35) !important;
    text-decoration: line-through !important;
  }

  /* ─── MOBILE ─────────────────────────────────────────────── */
  @media (max-width: 767px) {
    .coll-grid .pc--offset { margin-top: 0 !important; }

    .coll-grid .pc__info   { margin-top: 0.9rem !important; }

    .coll-grid .pc__name {
      font-size:      0.78rem !important;
      letter-spacing: 0.1em !important;
      white-space:    normal !important;
      overflow:       visible !important;
      text-overflow:  clip !important;
    }

    .coll-grid .pc__price  { font-size: 0.9rem !important; margin-top: 0.35rem !important; }
  }
{% endstylesheet %}
