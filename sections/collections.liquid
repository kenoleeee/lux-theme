{% comment %}
  List-collections page — "High-End Editorial Index" dark theme
  Layout: full-width index list, 2-col grid, text+small-thumb per row.
{% endcomment %}

{% comment %}
  {% style %} is inlined in <head> via content_for_header — wins over async {% stylesheet %}.
  Use it to lock critical colours that theme global CSS would otherwise override.
{% endcomment %}
{% style %}
  .shopify-section:has(.clx),
  .clx,
  .clx__header,
  .clx__top-rule,
  .clx__index {
    background-color: #0a0a09 !important;
    background:       #0a0a09 !important;
  }

  .clx__title {
    font-family:    sans-serif !important;
    font-weight:    100 !important;
    font-size:      clamp(3.8rem, 12vw, 13rem) !important;
    line-height:    0.86 !important;
    letter-spacing: -0.05em !important;
    text-transform: uppercase !important;
    color:          #e6e1d6 !important;
  }

  .clx,
  .clx__row,
  .clx__name,
  .clx__num,
  .clx__desc,
  .clx__cta,
  .clx__meta {
    color: #e6e1d6 !important;
  }
{% endstyle %}

{%- assign total_colls = collections | size -%}

<div class="clx full-width">

  {% comment %} ── PAGE HEADER ─────────────────────────────────────────────── {% endcomment %}
  <header class="clx__header">
    <h1 class="clx__title">{{ 'collections.index_title' | t }}</h1>
    <p class="clx__meta">
      <span class="clx__meta-count">{{ total_colls }}</span>
      <span class="clx__meta-label">{{ 'collections.meta_label' | t }}</span>
    </p>
  </header>

  {% comment %} ── DIVIDER ─────────────────────────────────────────────────── {% endcomment %}
  <div class="clx__top-rule"></div>

  {% comment %} ── INDEX GRID ──────────────────────────────────────────────── {% endcomment %}
  <div class="clx__index" aria-label="{{ 'collections.index_title' | t }}">
    {% for collection in collections %}

      {%- comment -%} zero-padded index number {%- endcomment -%}
      {%- if forloop.index < 10 -%}
        {%- assign idx_str = '0' | append: forloop.index -%}
      {%- else -%}
        {%- assign idx_str = forloop.index -%}
      {%- endif -%}

      {%- comment -%} stagger delay: 55ms × index, capped at 8 steps {%- endcomment -%}
      {%- assign delay_idx = forloop.index0 -%}
      {%- if delay_idx > 7 -%}{%- assign delay_idx = 7 -%}{%- endif -%}
      {%- assign anim_delay = delay_idx | times: 55 | plus: 250 -%}

      {%- comment -%} eager-load first 4 images {%- endcomment -%}
      {%- assign img_loading = 'lazy' -%}
      {%- if forloop.index <= 4 -%}{%- assign img_loading = 'eager' -%}{%- endif -%}

      <a
        class="clx__row"
        href="{{ collection.url }}"
        style="--delay: {{ anim_delay }}ms;"
        aria-label="{{ collection.title | escape }}"
      >

        <span class="clx__num">[{{ idx_str }}]</span>

        <div class="clx__info">
          <h2 class="clx__name">{{ collection.title | escape }}</h2>
          {% if collection.description != blank %}
            <p class="clx__desc">
              {{ collection.description | strip_html | truncatewords: 12 }}
            </p>
          {% endif %}
          <span class="clx__cta">{{ 'collections.view_collection' | t }}</span>
        </div>

        <div class="clx__thumb" aria-hidden="true">
          {% if collection.featured_image %}
            {{ collection.featured_image
              | image_url: width: 600, height: 800, crop: 'center'
              | image_tag:
                class: 'clx__thumb-img',
                loading: img_loading,
                widths: '300, 450, 600',
                sizes: '20vw'
            }}
          {% else %}
            <div class="clx__thumb-empty"></div>
          {% endif %}
        </div>

      </a>
    {% endfor %}
  </div>

</div>

{% stylesheet %}
  /* ── Tokens ──────────────────────────────────────────────── */
  .clx {
    --bg:    #0a0a09;
    --cream: #e6e1d6;
    --muted: rgba(230, 225, 214, 0.42);
    --line:  rgba(230, 225, 214, 0.09);
    --serif: var(--font-heading--family, "Playfair Display", Georgia, serif);
    --sans:  var(--font-body--family,    "Work Sans", system-ui, sans-serif);
  }

  /* ── Wrapper + kill all Shopify section overrides ────────── */
  .clx,
  .clx *,
  .shopify-section:has(.clx) {
    box-sizing: border-box;
  }

  .clx {
    background:       #0a0a09 !important;
    background-color: #0a0a09 !important;
    color:            #e6e1d6 !important;
    padding-top:      0 !important;
    padding-bottom:   0 !important;
  }

  /* ensure the Shopify section wrapper itself is dark */
  .shopify-section:has(.clx) {
    background:       #0a0a09 !important;
    background-color: #0a0a09 !important;
    margin:           0 !important;
    padding:          0 !important;
  }

  .clx__header,
  .clx__top-rule,
  .clx__index {
    background: #0a0a09 !important;
  }

  /* ═══════════════════════════════════════════════════════════
     PAGE HEADER
  ═══════════════════════════════════════════════════════════ */
  .clx__header {
    padding:        clamp(5.5rem, 11vh, 8rem) clamp(1.5rem, 5vw, 5rem) 1.8rem;
    display:        flex;
    align-items:    baseline;
    gap:            2rem;
    flex-wrap:      wrap;
  }

  /* Huge ultra-thin title */
  .clx__title {
    font-family:    var(--sans) !important;
    font-weight:    100 !important;
    font-size:      clamp(3.8rem, 12vw, 13rem) !important;
    line-height:    0.86 !important;
    letter-spacing: -0.05em !important;
    text-transform: uppercase !important;
    color:          #e6e1d6 !important;
    margin:         0 !important;
    /* entrance animation */
    animation: clx-slide-in 1s cubic-bezier(0.23, 1, 0.32, 1) 0.05s both;
  }

  .clx__meta {
    display:     flex;
    align-items: baseline;
    gap:         0.4rem;
    margin:      0;
    /* align to bottom of the huge title */
    align-self:  flex-end;
    padding-bottom: 0.3rem;
    animation: clx-slide-in 0.9s cubic-bezier(0.23, 1, 0.32, 1) 0.15s both;
  }

  .clx__meta-count {
    font-family:    var(--serif);
    font-style:     italic;
    font-size:      1.4rem;
    color:          var(--cream);
    opacity:        0.5;
  }

  .clx__meta-label {
    font-family:    var(--sans);
    font-size:      0.55rem;
    letter-spacing: 0.28em;
    text-transform: uppercase;
    color:          var(--muted);
  }

  /* ── Top rule (header → index separator) ─────────────────── */
  .clx__top-rule {
    height:     1px;
    background: var(--line);
    margin:     0 clamp(1.5rem, 5vw, 5rem);
    animation:  clx-rule-in 0.6s ease 0.2s both;
  }

  /* ═══════════════════════════════════════════════════════════
     INDEX GRID — 2 cols desktop, 1 col mobile
  ═══════════════════════════════════════════════════════════ */
  .clx__index {
    display:               grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    column-gap:            0;
    row-gap:               0;
    padding:               0 clamp(1.5rem, 5vw, 5rem) clamp(4rem, 8vw, 6rem);
  }

  /* ── ROW ──────────────────────────────────────────────────── */
  .clx__row {
    display:         flex;
    align-items:     center;
    gap:             1.4rem;
    padding:         clamp(1.4rem, 3vh, 2.2rem) 0 clamp(1.4rem, 3vh, 2.2rem) 0;
    text-decoration: none;
    color:           var(--cream);
    border-bottom:   1px solid var(--line);
    /* right column gets a left divider on desktop */
    position:        relative;
    transition:      background 350ms ease;
    /* stagger entrance animation */
    animation:       clx-slide-in 0.7s cubic-bezier(0.23, 1, 0.32, 1) var(--delay, 300ms) both;
  }

  /* left column: no extra border */
  .clx__row:nth-child(odd)  { padding-right: 2rem; }
  /* right column: thin vertical separator on left */
  .clx__row:nth-child(even) {
    padding-left:  2rem;
    border-left:   1px solid var(--line);
  }

  /* hover: very subtle cream tint */
  .clx__row:hover {
    background: rgba(230, 225, 214, 0.028);
  }

  /* ── INDEX NUMBER ─────────────────────────────────────────── */
  .clx__num {
    font-family:    var(--sans);
    font-size:      0.58rem;
    letter-spacing: 0.14em;
    color:          var(--cream);
    opacity:        0.38;
    flex-shrink:    0;
    line-height:    1;
    align-self:     flex-start;
    padding-top:    0.4rem;
  }

  /* ── INFO BLOCK ───────────────────────────────────────────── */
  .clx__info {
    flex:          1 1 auto;
    min-width:     0;
    display:       flex;
    flex-direction: column;
    gap:           0.45rem;
  }

  /* Collection name: serif italic, the focal element */
  .clx__name {
    font-family:    var(--serif) !important;
    font-style:     italic !important;
    font-weight:    400 !important;
    font-size:      clamp(1.5rem, 2.8vw, 3rem) !important;
    line-height:    1.05 !important;
    letter-spacing: -0.01em !important;
    color:          #e6e1d6 !important;
    margin:         0 !important;
    transition:     opacity 300ms ease;
    /* ellipsis on overflow */
    white-space:    nowrap;
    overflow:       hidden;
    text-overflow:  ellipsis;
  }

  .clx__row:hover .clx__name { opacity: 0.75; }

  /* brief description — shows only if present */
  .clx__desc {
    font-family: var(--sans);
    font-size:   0.7rem;
    line-height: 1.6;
    color:       var(--muted);
    margin:      0;
    max-width:   36ch;
    white-space: nowrap;
    overflow:    hidden;
    text-overflow: ellipsis;
  }

  /* CTA — muted underline text, visible on hover */
  .clx__cta {
    display:        inline-block;
    font-family:    var(--sans);
    font-size:      0.56rem;
    letter-spacing: 0.26em;
    text-transform: uppercase;
    color:          var(--muted);
    border-bottom:  1px solid transparent;
    padding-bottom: 2px;
    width:          fit-content;
    transition:     color 250ms ease, border-color 250ms ease;
  }

  .clx__row:hover .clx__cta {
    color:        var(--cream);
    border-color: rgba(230, 225, 214, 0.4);
  }

  /* ── THUMBNAIL (right, 3:4, ~28% width) ──────────────────── */
  .clx__thumb {
    width:         28%;
    flex-shrink:   0;
    aspect-ratio:  3 / 4;
    overflow:      hidden;
    /* thumbnail stays on the right edge */
    margin-left:   auto;
  }

  .clx__thumb-img {
    display:    block;
    width:      100%;
    height:     100%;
    object-fit: cover;
    transition: transform 650ms cubic-bezier(0.23, 1, 0.32, 1),
                filter 400ms ease;
    filter:     saturate(0.7) contrast(1.08);
  }

  .clx__row:hover .clx__thumb-img {
    transform: scale(1.06);
    filter:    saturate(0.9) contrast(1.04);
  }

  .clx__thumb-empty {
    width:      100%;
    height:     100%;
    background: linear-gradient(150deg, #1e1e1c 0%, #2a2a27 100%);
  }

  /* ── ENTRANCE ANIMATIONS ──────────────────────────────────── */
  @keyframes clx-slide-in {
    from { opacity: 0; transform: translateY(16px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  @keyframes clx-rule-in {
    from { opacity: 0; transform: scaleX(0); transform-origin: left; }
    to   { opacity: 1; transform: scaleX(1); }
  }

  /* ── RESPONSIVE ───────────────────────────────────────────── */
  @media (max-width: 900px) {
    .clx__name { font-size: clamp(1.4rem, 4vw, 2.2rem); }
    .clx__thumb { width: 24%; }
  }

  @media (max-width: 640px) {
    .clx__header {
      padding:     clamp(5rem, 13vh, 7rem) 1.2rem 1.4rem;
      gap:         1rem;
      flex-direction: column;
      align-items: flex-start;
    }

    .clx__title {
      font-size:   clamp(2.8rem, 16vw, 5rem);
    }

    .clx__meta { align-self: auto; }

    .clx__top-rule { margin: 0 1.2rem; }

    .clx__index {
      grid-template-columns: 1fr;
      padding: 0 1.2rem clamp(3rem, 8vw, 5rem);
    }

    /* remove column divider on mobile */
    .clx__row:nth-child(even) {
      border-left:  none;
      padding-left: 0;
    }
    .clx__row:nth-child(odd) { padding-right: 0; }

    .clx__name { font-size: clamp(1.5rem, 7vw, 2.2rem); }
    .clx__thumb { width: 30%; }
    .clx__desc { display: none; }
  }

  /* ── Respect reduced motion ───────────────────────────────── */
  @media (prefers-reduced-motion: reduce) {
    .clx__title,
    .clx__meta,
    .clx__top-rule,
    .clx__row { animation: none; opacity: 1; }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "t:general.collections_grid",
  "settings": [],
  "presets": [{ "name": "t:general.collections_grid" }]
}
{% endschema %}
